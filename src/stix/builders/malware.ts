import type { StixMalware } from "../types";
import { uuid } from "../utils";

export class MalwareBuilder {
  private malware: StixMalware;

  constructor() {
    this.malware = {
      spec_version: "2.1",
      type: "malware",
      id: `malware--${uuid()}`,
      created: new Date().toISOString(),
      modified: new Date().toISOString(),
      name: "",
    };
  }

  id(id: string): MalwareBuilder {
    this.malware.id = id;
    return this;
  }

  name(name: string): MalwareBuilder {
    this.malware.name = name;
    return this;
  }

  description(description: string): MalwareBuilder {
    this.malware.description = description;
    return this;
  }

  malwareTypes(malwareTypes: string[]): MalwareBuilder {
    this.malware.malware_types = malwareTypes;
    return this;
  }

  build(): StixMalware {
    return this.malware;
  }
}

export function Malware(): MalwareBuilder {
  return new MalwareBuilder();
}
